#Scans Subdirectorys for Executables
#Copys Files form Source to a specific Drive
$Script:MaximumFilSize = 300*1024 #300 KB
$Script:SampleDropDir ="E:\"
$Script:DirToCrawl = "C:\"



$allItems = get-childitem $Script:DirToCrawl -Recurse -include *.exe | Where-Object {$_.Length -lt $Script:MaximumFilSize}

Test-Path $Script:SampleDropDir

foreach($item in $allItems){
    $fullTargetPath=$Script:SampleDropDir+$item.Name
    $item.CopyTo($fullTargetPath,$false)
}